---
// src/pages/category/[category].astro
import Base from "../../layouts/Base.astro";
export async function getStaticPaths() {
  const recalls = (await import("../../../data/recalls.json")).default;
  const uniq = new Map();
  for (const r of recalls) {
    if (!uniq.has(r.categorySlug)) uniq.set(r.categorySlug, r.category);
  }
  return Array.from(uniq, ([slug, name]) => ({ params: { category: slug }, props: { name } }));
}

const { name } = Astro.props;
const categorySlug = Astro.params.category;
const recalls = (await import("../../../data/recalls.json")).default;
const items = recalls.filter(r => r.categorySlug === categorySlug);
const title = `${name} Recalls`;
const description = `Recent ${name} recalls`;
const canonical = `https://recallwatch.pages.dev/category/${categorySlug}`;
---

<Base title={title} description={description} canonical={canonical}>
      <h1>{title}</h1>
      <ul>
        {items.map(r => <li><a href={`/recalls/${r.id}`}>{r.brand} — {r.product}</a> — {r.hazard || 'Safety notice'}</li>)}
      </ul>
</Base>
